var gfeloqua_clear_form_transient,gfeloqua_clear_forms_transient,gfeloqua_oauth_window,GFEloqua=window.GFEloqua||{};!function(s){GFEloqua.oauth_window=!1,GFEloqua.init=function(){this.bind_form_refresh(),this.bind_field_refresh(),this.bind_oauth(),this.bind_select_ui(),this.bind_retry(),this.bind_entry_notes_ui(),this.bind_test()},GFEloqua.bind_form_refresh=function(){s('a[href$="#gfe-forms-refresh"]').on("click",function(e){return e.preventDefault(),GFEloqua.clear_forms_transient(),!1})},GFEloqua.bind_field_refresh=function(){s('a[href$="#gfe-form-fields-refresh"]').on("click",function(e){return e.preventDefault(),GFEloqua.clear_form_transient(),!1})},GFEloqua.bind_oauth=function(){s("#gfeloqua_oauth").on("click",function(e){e.preventDefault();var t=s(this).attr("href"),n=s(this).data("width")?s(this).data("width"):600,o=s(this).data("height")?s(this).data("height"):600,i=GFEloqua.popup(t,"gfeloqua_oauth",n,o);s(this).hide(),s("#gfeloqua_oauth_code").show();var a=function(){setTimeout(function(){i.closed?(s("#gfeloqua_oauth_code").html(gfeloqua_strings.oauth_complete),location.reload(!0)):a()},500)};return a(),!1})},GFEloqua.bind_select_ui=function(){s.fn.select2&&s("select#gfeloqua_form").length&&s("select#gfeloqua_form").select2({minimumResultsForSearch:10,width:"100%"}).on("change",function(){var e=s("<div />").addClass("spinner"),t=s("#gaddon-setting-row-mapped_fields td");if(!s("#gfeloqua_form").val())return!1;e.show().css("visibility","visible"),t.length?(t.find("table").hide(),t.append(e)):(e.css("display","inline-block").css("float","none"),s("#gform-settings-save").after(e)),s(this).parents("form").submit()})},GFEloqua.bind_note_detail_toggle=function(){s("a.toggle-debug-detail, a.toggle-note-detail").off("click").on("click",function(e){e.preventDefault(),s(this).hasClass("toggle-note-detail")?s(this).next(".gfeloqua-note-detail").slideToggle("fast"):s(this).next(".gfeloqua-debug-detail").slideToggle("fast")})},GFEloqua.bind_entry_notes_ui=function(){s("a.gfeloqua-debug-toggle").off("click").on("click",function(e){e.preventDefault(),s(this).next(".gfeloqua-advanced-debug").slideToggle("fast")})},GFEloqua.bind_retry=function(){s(".gfeloqua-retry").on("click",function(e){e.preventDefault();var t=s(this),n=t.data("entry-id"),o=t.data("form-id"),i=s(".gfeloqua-right .spinner"),a=s(".gfeloqua-retries");i.length||(i=s("<div />").addClass("spinner"),a.before(i)),i.show().css("visibility","visible").css("float","left"),s.ajax({url:gfeloqua_strings.ajax_url,data:{action:"gfeloqua_resubmit_entry",entry_id:n,form_id:o},success:function(e){e.success?(s(".gfeloqua-retries").remove(),t.remove()):(s(".gfeloqua-retries span").html(e.retries),e.limit_reached&&s(".gfeloqua-retries").addClass("gfeloqua-limit-reached")),i.hide(),s("#gfeloqua-notes").html(e.notes),GFEloqua.bind_entry_notes_ui()}})})},GFEloqua.bind_false_positives=function(){s(".gfeloqua-false-positive").on("click",function(e){if(e.preventDefault(),!confirm(gfeloqua_strings.confirm_reset))return!1;var t=s(this),n=t.data("entry-id"),o=t.data("form-id");s.ajax({url:gfeloqua_strings.ajax_url,data:{action:"gfeloqua_reset_entry",entry_id:n,form_id:o},success:function(e){e.success&&location.reload()}})})},GFEloqua.clear_form_transient=function(){var e=s("<div />").addClass("spinner"),t=s("#gaddon-setting-row-mapped_fields td"),n=s("#gfeloqua_form").val();if(!n)return!1;e.show().css("visibility","visible"),t.find("table").hide(),t.append(e),s.ajax({url:gfeloqua_strings.ajax_url,data:{action:"gfeloqua_clear_transient",transient:"assets/form/"+n},success:function(e){s("#gform-settings").submit()}})},GFEloqua.clear_forms_transient=function(){var e=s("<div />").addClass("spinner"),t=s("#gaddon-setting-row-gfeloqua_form td");e.show().css("visibility","visible"),t.find("select, .select2-container").hide(),t.append(e),s.ajax({url:gfeloqua_strings.ajax_url,data:{action:"gfeloqua_clear_transient",transient:"assets/forms"},success:function(e){s("#gform-settings").submit()}})},GFEloqua.popup=function(e,t,n,o){var i=null!=window.screenLeft?window.screenLeft:screen.left,a=null!=window.screenTop?window.screenTop:screen.top,s=(window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-n/2+i,l=(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-o/2+a;return GFEloqua.oauth_window=window.open(e,t,"scrollbars=yes, chrome=yes, menubar=no, toolbar=no, width="+n+", height="+o+", top="+l+", left="+s),window.focus&&GFEloqua.oauth_window.focus(),GFEloqua.oauth_window},GFEloqua.bind_test=function(){s("#gfeloqua_test").on("click",function(e){s(".gfeloqua-connection-test-result").remove();var t=s(this).parents("td").find(".spinner");if(t.length||(t=s("<div />").addClass("spinner").hide(),s("#gfeloqua_test").after(t)),t.is(":visible"))return!1;t.show().css("visibility","visible").css("float","none"),e.preventDefault(),s.ajax({url:gfeloqua_strings.ajax_url,data:{action:"gfeloqua_connection_test"},type:"post",dataType:"json",success:function(e){t.hide(),s("#gfeloqua_test").after(e.html)}})})},gfeloqua_clear_form_transient=function(){return console.warn("gfeloqua_clear_form_transient has been deprecated."),GFEloqua.clear_form_transient()},gfeloqua_clear_forms_transient=function(){return console.warn("gfeloqua_clear_forms_transient has been deprecated."),GFEloqua.clear_forms_transient()},PopupCenter=function(e,t,n,o){return console.warn("PopupCenter has been deprecated."),GFEloqua.popup(e,t,n,o)},gfeloqua_bind_note_detail_toggle=function(){return console.warn("gfeloqua_bind_note_detail_toggle has been deprecated."),GFEloqua.bind_note_detail_toggle()},s(function(){GFEloqua.init()})}(jQuery);
var GFEloqua=window.GFEloqua||{};!function(t){GFEloqua.Extensions={},GFEloqua.Extensions.init=function(){GFEloqua.Extensions.bind_save_settings_form()},GFEloqua.Extensions.bind_save_settings_form=function(){t(".gfeloqua-extension-settings").on("click",".gfeloqua-save-extension-settings",function(n){n.preventDefault(),GFEloqua.Extensions.show_spinner();var s=t(this).parents(".gfeloqua-extension-settings"),e=s.find(".gfeloqua-settings-fields"),i=s.find(".gfeloqua-extension-settings-errors"),o=s.find(":input").serialize();return i.hide(),o+="&action=gfeloqua_save_extension_settings",t.ajax({data:o,url:gfeloqua_strings.ajax_url,type:"post",success:function(n){n.success||i.html(n.error).show(),e.html(n.html),GFEloqua.Extensions.hide_spinner()}}),!1})},GFEloqua.Extensions.show_spinner=function(){var n=t("#TB_window"),s=n.find(".gfeloqua-spinner");if(!s.length){var e=t("<div />").addClass("inside"),i=t("<span />").addClass("loader");e.append(i),s=t("<div />").addClass("gfeloqua-spinner").append(e),n.append(s),s=n.find(".gfeloqua-spinner")}s.show()},GFEloqua.Extensions.hide_spinner=function(){t("#TB_window .gfeloqua-spinner").hide()},t(function(){GFEloqua.Extensions.init()})}(jQuery);